<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css" integrity="sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS" crossorigin="anonymous">
    
  <title>王摸摸點餐系統</title>
  <style>
      .error{
        color: mediumslateblue;
      }
  </style>  
</head>
  <body>  
    <div class="container">
    <h1 class="text-center mt-5">●王摸摸點餐系統●</h1>
    
    <!-- 表單返回頁，記得在表單加「 target='returnWin' 」 -->
    <iframe name="returnWin" style="display: none;" onload="this.onload=function(){window.location='ok.html'}"></iframe> 

    <form target='returnWin' role="form" action="https://docs.google.com/forms/u/0/d/e/1FAIpQLSf1CKOZ0osqPCllf7O3ujqz8OW2rHTOpDhojOeGAXxI77A4FQ/formResponse" method="post" id="myForm">
        <div class="row">         
            <!--桌號-->              
                <div class="col-sm-3">
                <div class="form-group">
                <label>桌號<span class="text-danger">*</span></label>
                <select name="entry.156365925" id="156365925" class="form-control" size="1">              
                    <option value="">~你的桌號~</option>
                    <option value="1號桌">1號桌</option>
                    <option value="2號桌">2號桌</option>
                    <option value="3號桌">3號桌</option>
                    <option value="4號桌">4號桌</option>
                    <option value="5號桌">5號桌</option>
                    <option value="6號桌">6號桌</option>
                </select>
                </div>
                </div>   
            <!--合計--> 
            <div class="col-sm-3">
                <div class="form-group">
                <label>合計</label>
                <input type="text" class="form-control" name="total" id="total" value="" readonly> 
                </div>
            </div>                  
                <div class="row">
                <!--雞腿飯-90元-->              
                <div class="col-sm-3">
                    <div class="form-group">
                    <label>
                        <img src="img/leg.jpg" width="30%"><img><br>
                        <span class="title" style="color: blueviolet;">雞腿飯-90元 </span><span style="color: brown;"> *請填數量</span></label>
                    <input type="number" class="form-control amount" name="entry.771947827" id="771947827" value="0" min="0" onchange="calTotal();"> 
                    <!-- 可以在尾巴加上min="0"就會強制不能選填負數 -->
                </div>
                    <!-- type = text 為可以打字不輸數量 -->
                </div>          
                <!--雞排飯-80元-->              
                <div class="col-sm-3">
                    <div class="form-group">
                    <label>
                        <img src="img/leg.jpg" width="30%"><img><br>
                        <span class="title" style="color: rgb(36, 172, 31);">雞排飯-80元</span><span style="color: darkblue;">*(請填數量)</span></label>
                    <input type="number" class="form-control amount" name="entry.1847083733" id="1847083733" value="0" onchange="calTotal();">
                    </div>
                </div>          
                <!--排骨飯-70元-->              
                <div class="col-sm-3">
                    <div class="form-group">
                    <label>
                        <img src="img/leg.jpg" width="30%"><img><br>
                        <span class="title" style="color: blueviolet;">排骨飯-70元</span><span style="color: darkblue;">*(請填數量)</span></label>
                    <input type="number" class="form-control amount" name="entry.1859116598" id="1859116598" value="0" onchange="calTotal();">
                </div>
                </div>          
                <!--招牌飯-60元-->              
                <div class="col-sm-3">
                    <div class="form-group">
                    <label>
                        <img src="img/leg.jpg" width="30%"><img><br>
                        <span class="title" style="color:darkslategray;">招牌飯-60元</span><span style="color:darkorange;">*(請填數量)</span></label>
                    <input type="number" class="form-control amount" name="entry.1910485733" id="1910485733" value="0" onchange="calTotal();">
                    </div>
                </div> 
              <div class="row">
              <div class="col-sm-12">  
                <!-- 備註 -->
                    <div class="form-group">
                    <label class="control-label">備註</label>
                    <textarea class="form-control" rows="3" id="478990908" name="entry.478990908">我想要說</textarea>
                    </div>
                </div>
            </div> 
                <div class="text-center pb-3">
                <button type="submit" class="btn btn-primary">送出</button>
                </div>
            </form>
        </div>

    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js" integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js" integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k" crossorigin="anonymous"></script>
    <!-- 表單驗證 -->
    <script src="https://cdn.jsdelivr.net/npm/jquery-validation@1.19.1/dist/jquery.validate.min.js"></script>
 
     <!-- jquery的基本用法 
    https://codertw.com/%E5%89%8D%E7%AB%AF%E9%96%8B%E7%99%BC/270803/
     -->
<!-- 調用函式方法 -->
 <script>
    $(function(){
        $("#myForm").validate({
            submitHandler: function(form) {
                form.submit();
            },
    rules:{
                'entry.156365925':{ //桌號
                    required: true
                },
                'entry.771947827': {//雞腿飯
                    digits: true,
                    min: "0"
                },
                'entry.1847083733': {//雞排飯
                    digits: true,
                    min: "0"
                }, 
                'entry.1859116598': {//排骨飯
                    digits: true,
                    min: "0"
                },
                'entry.1910485733': {//招牌飯
                    digits: true,
                    min: "0"
                },
                'total':{ //合計
                    required: true
                }
           },
    messages: {
                'entry.156365925':{ //桌號
                    required: "請輸入桌號"
                },
                'entry.771947827': {//雞腿飯
                    digits:"請填正確數量" ,
                    min: "請填正確數量"
                },
                'entry.1847083733': {//雞排飯
                    digits: "請輸入正確數量",
                    min: "請填正確數量"
                }, 
                'entry.1859116598': {//排骨飯
                    digits: "請填正確數量",
                    min: "請填正確數量"
                },
                'entry.1910485733': {//招牌飯
                    digits: "請填正確數量",
                    min: "請填正確數量"
                },
                'total':{ //合計
                    required: "尚未點餐"
                }
               
            }
        }); 
    });
</script>

<script>
    // 合計金額
    function calTotal(){
    // document.getElementsByClassName("title")[0].innerText //取數值
    // document.getElementsByClassName("amount")[0].value //取數值
    var titles = document.getElementsByClassName("title");     
    var amounts = document.getElementsByClassName("amount"); 
    var total =0;
    for(var i=0; i < titles.length; i++){
        var title = document.getElementsByClassName("title")[i].innerText;
        var amount = document.getElementsByClassName("amount")[i].value;
        var subArr = title.split("-"); 
        // 字串分割split
        var price = parseInt(subArr[1]); //這邊的[1]是因為切割後取右邊的值
        // total = total + (amount * price); 比較基礎的寫法, 下面是比較進階的
        total += (amount * price);
    }
    if(total === 0){
         document.getElementById("total").value = total;
    }else{
        document.getElementById("total").value = total;
    }
}   
    </script>
</body>
</html>